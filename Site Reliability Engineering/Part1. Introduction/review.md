## SRE 가 뭘까?
기존 소프트웨어 엔지니어링인 기획과 설계에 집중하다면, SRE 는 소프웨어 생명주기의 운영 및 개선에 대한 엔지니어링이다.
SRE 엔제니어는 시스템의 신뢰성에 집중한다. SRE 는 시스템을 더 확장가능하고 안정적이며 효율적으로 만들기 위해서 설계와 운영을 개선한다.
충분히 안정적이라고 생각되었다면 남은 시간을 기능 개발·성능 개선·신뢰성 향상에 재투자한다

## Sysadmin 의 한계
sysadmin 은 시스템의 부하가 증가함에 따라서 팀의 사이즈도 확대 된다. 운영팀과 제품개발팀의 이익이 달라 융합되지 못하고 갈등이 빈번하다.

## 구글의 접근방식: SRE
SRE 은 소프트웨어 엔지니어에게 운영을 설계하라고 했을 때 탄생하는 것이다.
SRE 팀은 sysadmin 이 수동으로 하던 일을 자동화 하는 시스템을 만드는 엔지니어를 고용한다.
SRE 팀은 운영업무의 상한선을 총 일의 양의 50% 로 제한 하고 있다.
이러한 의식적인 균형을 통해서 시스템을 안정적이고 운영이 용이하도록 하는데 필요한 시간을 확보할 수 있다.
이는 상한선으로 이상적으로는 지속적인 개선으로 거의 대부분의 시간을 개발에 참여하도록 하는 것이다.

SRE 접근 방식은 시스템의 규모에 따라서 팀사이즈가 비례하여 증가하지 않음으로 운영비용이 낮다.  
또한 운영팀과 개발팀간에 이동을 자유롭게 하여 상호학습을 통해 엔지니어의 역량을 키울 수 있다. (같은 관점을 가질 수 있음으로 갈등도 당연히 줄어들 것이다.)

※ SRE 는 DevOps 구글에서의 구현체 이다.

## SRE 의 신조
SRE 는 다음과 같은 서비스의 프러덕션 측면에 대한 책임이 있고 이어서 소개하는 핵심 신조를 따른다.
이러한 신조들은 SRE 팀이 엔지니어링 작업에 집중할 수 있도록 도와준다. 
- availability 
- latency,
- performance 
- efficiency
- change management 
- monitoring
- emergency response
- capacity planning

### 엔지니어링에 대한 지속적인 집중 보장
SRE 의 운영작업량을 모니터링해서 전체 작업의 50%를 초과하면, 제품개발 팀으로 초과된 운영업무를 이관한다.
운영 부담이 50% 이하로 떨어질때까지 계속 된다.
이는 운영에 사람의 개입이 필요하지않는 시스템을 만드는 피드 메커니즘으로 작용한다.
사고에 대해서 사후분석을 한다. 구글은 비난없는 사후분석 문화를 가지고 있는데 이는 문제를 드러내고 엔지니어링 방식으로 해결하게 한다.

### 서비스의 SLO 를 위반하지 않으면서 변화속도의 극대화 추구
제품 개발팀과 SRE 팀의 구조적인 충돌을 에러버짓 이라는 개념을 통해 명시화 하고 다룰 수 있다.
에러버짓은 100% 의 신뢰성이 잘못되었다는 가정에서 시작된다.
유저는 99.999% 와 100% 의 가용성 차이를 느낄 수 없고, 0.001%를 채우기 위한 막대한 노력은 사용자에게 실질적인 이득을 주지 않는다.
올바른 신뢰성 목표는 제품에 대한 질문이다. 다음과 같은 질문으로 바탕으로 SLO 가 설정된다.
- 사용자가 만족하는 가용성은 얼마인가?
- 불만족하는 경우 선택할 수 있는 대체제는?
- 가용성 수준에 따라서 사용자의 행동은 어떻게 달라지는가

이렇게 해서 SLO 가 99.99% 의 가용성목표가 설정된다면 허용되는 비 가용성은 0.01% 이고 이것이 에러버짓 이다.  
에러버짓 = 100 % - SLO
제품개발팀은 기능을 빠르게 출시하고 사용자를 확보하는데 에러버짓을 최대한 활용해야 한다.
이 프레임워크 내에서 단계적 배포와 같은 전략으로 에러버짓의 소비속도를 줄이는 것으로 빠른 출시를 최적화 할 수 있다.

에러버짓은 제품 개발팀과 SRE 팀 간의 동인의 충돌을 해소한다. SRE 의 목표는 장애를 완전히 없애는 것이 아니다.
SRE 와 제품개발팀은 에러버짓을 활용해서 변화의 속도를 극대화 하는것이 된다.
장애를 나쁜것이 아니라 혁신의 과정에서 발생하는 것으로 인지하고 관리해야할 일상적인 것으로 인식하는 전환은 매우 중요하다.

### 모니터링(감시)
모니터링은 서비스의 오너가 시스템의 건강상태와 가용성을 지속적으로 추적할수 있는 주요한 수단이다.
경고에 부문에서 모니터링은 사람에게 해석을 요구해서는 안된다. 소프트웨어가 해석을 해야하고 사람의 행동이 필요될 때 알려져야 한다.  
모니터링의 출력은 다음과 같다.
- Alerts: 이에 대한 응답으로 사람이 즉시 행동을 취하여야 하는 것.
- Tickets: 이에 대한 응담으로 행동을 취하여야 하는 것. 시스템이 자동으로 상황을 다룰 수 없는 것.
- Logging: 진단을 위해서 기록되는 것으로, 다른 무언가가 로그 확인을 촉발하지 않는 한 아무도 로그를 읽지 않는다는 것이 기본적인 기대 이다.

### 긴급대응
신뢰성은 MTTF 와 MTTR 의 함수이다.
- MTTF(Mean Time To Failure): 한 번 고장 나기까지 시스템이 평균적으로 정상 동작한 시간
- MTTR(Mean Time To Repair): 고장 후 복구·수리해 다시 정상 상태가 되기까지 걸린 평균 시간
- MTBF(Mean Time Between Failures): 한 고장에서 다음 고장까지의 평균 주기

사람의 개입은 지연을 만든다. 사람의 개입이 필요한 시스템은 그렇지 않은 시스템보다 가용성이 낮다.
만약 사람의 개입이 필요한경우에 play-book 이 있는 경우, MTTR 가 수배 더 개선된다.
만능 엔지니어도 문제를 해결할 수는 있지만, play-book 갖춘 숙련된 온콜 엔지니어가 훨씬 더 효과적으로 일한다.
아무리 포괄적인 play-book 이라도 즉각적인 판단을 할 수 있는 뛰어난 엔지니어를 대체할 수 없지만,
명확하고 상세한 문제 해결절차와 팁은 위험이 크거나 시간이 촉박한 alert 에 대응할 때 가치가 있다.

### 변경 관리
장애의 70% 는 변경에 의한 것이다. 이 문제영역의 모범사례는 다음과 같은 것을 달성하기 위해 자동화를 사용하는 것이다.
- 점진적 롤아웃의 구현
- 빠르고 정확한 문제 감지
- 문제가 일어났을 때, 안전한 변경의 롤백
위 세가지 실천은 나쁜 변경에 유저나 운영에 노출되는 것을 최소하 한다. 
이러한 실천에서 사람의 개입을 배제해서 피로와, 익숙함, 반복된 작업에 대한 부주의와 같은 문제를 제거할 수 있고,
릴리즈 속도와 안전성이 모두 향상된다.

### 수요예측 및 용량계획 (Capacity Planning)
※ 용량: 시스템이 SLO를 지키면서 지속적으로 감당할 수 있는 최대 부하
수요예측과 용량계획은 요구되는 가용성을 유지하면서 미래의 수요를 충족시키기 위한 충분한 용량과 중복성을 보장하는 수단으로 봐야 한다.
용량 계획은 유기적 성장(자연적인 사용자 수의 증가)과 비유기적 성장(기능 런치, 마케팅 켐페인)을 계산에 넣어야 한다.
다음과 같은 몇가지 단계가 필수적이다.
- 정확한 유기적인 수요 예측(용량을 확보하는데 걸리는 시간까지 계산에 포함한)
- 비유기적인 수요원인을 수요예측에 정확하게 반영하는 것.
- 주기적인 부하 테스트(상관되는 낮은 단계의 용량 부터 서비스 용량까지) 
용량은 가용성에 중대한 영향을 끼치므로 SRE 가 이것을 관리할 책임이 있다.

### Provisioning
프로비저닝은 변경 관리와 용량계획을 합친 것 이다. 프로비저닝은 용량(리소스)을 실제 시스템에 적용하는 과정이다.
예를들어 새로운 인스턴스를 추가하거나 로드벨런서 같은 기존 시스템을 수정한다.

### 효율성과 성능
리소스의 효율적인 사용은 비용과 관련되기 때문에 항상 중요하다.
활성도(utilization)는 서비스의 동작방식과 프로비저닝에 관한 함수이다.
서비스의 총 비용에 영향을 큰 영향을 미치는 미치는 프로비저닝 전략 그리고 활성도에 관계된 작업에는 SRE 가 반드시 관여해야한다.
리소스 사용은 부하, 용량, 소프트웨어 효율성에 관한 함수이다. 이 세가지는 서비스의 효율성을 차지하는 큰 부분이다.

소프트웨어 시스템은 부하가 증가하면 점점 느려진다. SRE 는 특정 응답속도에서의 용량목표를 달성하기 위해서 프로비저닝을 수행함으로 서비스의 성능에 큰 관심을 가진다.
SRE 와 제품 개발팀은 서비스이 성능을 향상시키기 위해서 이를 모니터링하고 수정하게 되며, 결과적으로 용량을 늘리고 효율성을 향상하는데 기여한다.

### The End of the Beginning
SRE 는 다음과 같은 동기로 시작되었다. - "소프트웨어 엔지니어로서, 반복적인 작업을 수행해야 한다면 이렇게 시간을 투자하고 싶다."
이제는 발전하여서 하나의 원칙집합, 실천방법집합, 인센티브 체계를 가진 전문영역이 되었다.



