# Types of Values 요약


# 문단별 흥미로운 내용
- 전체 실행 구조
  - main.runFile -> vm.interpret -> compiler.compile //청크에 bytecode 기록 -> vm.run//bytecode 실행
- 값의 표현방식이 어떻게 서로 다른 타입들을 동적으로 처리할 수 있게 되는지 배운다.
## 18.1 Tagged Unions
- C 에서는 낮은 비트 부터 데이터 스트럭쳐를 만들 수 있다. 하지만 또 그렇게 해야한 한다. C 관점에서 세계는 구분되지 않은 바이트 배열이다. 몇 바이트를 사용할지 어떻게 의미를 붙일지는 우리가 해야하는 일이다.
- 값의 표현을 위해서는 다음의 두가지 질문에 답해야 한다. "값의 타입을 어떻게 표현할 것인가?", "값 자체를 어떻게 저장해야 할까?" 이를 taged union 이라는 자료구조로 해결한다.
```c
typedef struct {
  ValueType type;
  union {
    bool boolean;
    double number;
  } as; 
} Value;
```
- 여기서 type 의 개념은 VM 의 것이지, user 의 것이 아니다. 유저가 정의한 타입은 VM 에서 전부 instance 라는 타입이 된다.
- 현재 우리가 정의한 값 타입은 모두 불변(immutable) 이다. 그래서 위 자료 구조로도 충분하다.
## 18.2 Lox Values and C Values
- 메크로 함수들을 이용해서 Lox 의 다이나믹 월드에서 C 의 스태틱 월드간에 데이터를 이동시킬 수 있다.
  - 전체 실행구조
    - main.runFile -> vm.interpret -> compiler.compile //청크에 bytecode 기록 -> vm.run//bytecode 실행
      - compiler.compile 실행구조
        - advance() 실행으로 첫 토큰을 준비하고, 첫 컴파일 expression() 을 실행 
        - compiler.parsePrecedence 의 재귀적인 루프에서 advance() 실행, 그 안에서 scanner.scanToken 을 실행하고 Parser 에 새로운 token 이 계속 해서 설정됨. 
  - 토큰을 식별하면 complier 의 number() 가 실행된다. number() 중간 자료구조인 Lox 의 Value 를 chunk 에 쓴다.


